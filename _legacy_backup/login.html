<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Secure Login | Centre for Peace Praxis</title>
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <!-- Modern Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Custom Glass Styles -->
    <link rel="stylesheet" href="login.css">
</head>

<body>

    <div class="login-container">
        <div class="login-card">

            <!-- Camera/Tech Badge Icon -->
            <div class="icon-badge">
                <i class="fas fa-camera"></i>
            </div>

            <div class="login-header">
                <h2>ADMIN ACCESS</h2>
            </div>

            <form id="loginForm">
                <div class="form-group">
                    <input type="text" id="username" class="form-control" placeholder="Username" required
                        autocomplete="off">
                    <i class="fas fa-user input-icon"></i>
                </div>

                <div class="form-group">
                    <input type="password" id="password" class="form-control" placeholder="Password" required>
                    <i class="fas fa-lock input-icon"></i>
                    <i class="fas fa-eye password-toggle" id="togglePassword"></i>
                </div>

                <div class="form-actions" style="justify-content: flex-end;">
                    <a href="#" class="forgot-link">Forgot Password?</a>
                </div>

                <div id="errorMsg" class="error-message">
                    <i class="fas fa-exclamation-triangle"></i> Invalid Credentials
                </div>

                <button type="submit" class="btn-login">
                    Login
                </button>
            </form>

            <div style="margin-top: 30px;">
                <a href="index.html"
                    style="color: rgba(255,255,255,0.4); text-decoration: none; font-size: 0.8rem; letter-spacing: 1px;">
                    <i class="fas fa-arrow-left"></i> BACK TO SITE
                </a>
            </div>
        </div>
    </div>

    <!-- Auth Logic -->
    <script src="auth.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Check session
            if (Auth.isAuthenticated()) {
                window.location.href = 'dashboard.html';
            }

            const loginForm = document.getElementById('loginForm');
            const usernameInput = document.getElementById('username');
            const passwordInput = document.getElementById('password');
            const errorMsg = document.getElementById('errorMsg');

            // Slight delay animation for inputs
            setTimeout(() => {
                usernameInput.focus();
            }, 500);

            loginForm.addEventListener('submit', function (e) {
                e.preventDefault();

                const username = usernameInput.value.trim();
                const password = passwordInput.value.trim();

                if (Auth.login(username, password)) {
                    // Success Animation before redirect
                    const btn = document.querySelector('.btn-login');
                    btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> ACCESSING...';
                    btn.style.background = 'linear-gradient(135deg, #10b981, #059669)';

                    setTimeout(() => {
                        window.location.href = 'dashboard.html';
                    }, 800);
                } else {
                    // Error Shake
                    errorMsg.style.display = 'block';
                    passwordInput.value = '';
                    passwordInput.focus();

                    // Reset animation
                    const card = document.querySelector('.login-card');
                    card.classList.remove('shake-anim');
                    void card.offsetWidth; // trigger reflow
                    card.classList.add('shake-anim');
                }
            });

            // Input handlers
            [usernameInput, passwordInput].forEach(input => {
                input.addEventListener('input', () => {
                    errorMsg.style.display = 'none';
                });
            });

            // Password Toggle Logic
            const togglePassword = document.getElementById('togglePassword');
            togglePassword.addEventListener('click', function () {
                // toggle the type attribute
                const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
                passwordInput.setAttribute('type', type);

                // toggle the eye / eye slash icon
                this.classList.toggle('fa-eye');
                this.classList.toggle('fa-eye-slash');
            });
        });
    </script>
</body>

</html>